"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[5673],{3186:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"branch-protection-policy","title":"Branch Protection Policy (proposed)","description":"This document defines recommended protection settings for main to ensure","source":"@site/docs/branch-protection-policy.md","sourceDirName":".","slug":"/branch-protection-policy","permalink":"/chatline/docs/branch-protection-policy","draft":false,"unlisted":false,"editUrl":"https://github.com/nathanvale/chatline/tree/main/website/docs/branch-protection-policy.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Automated Release Workflow","permalink":"/chatline/docs/automated-release-workflow"},"next":{"title":"Bun Hybrid Implementation Checklist","permalink":"/chatline/docs/bun-hybrid-implementation-checklist"}}');var r=i(6801),l=i(5705);const t={},c="Branch Protection Policy (proposed)",o={},d=[{value:"Overview",id:"overview",level:2},{value:"Required status checks",id:"required-status-checks",level:2},{value:"Additional protections",id:"additional-protections",level:2},{value:"Tag-driven release flow",id:"tag-driven-release-flow",level:2},{value:"Security considerations",id:"security-considerations",level:2},{value:"Future enhancements",id:"future-enhancements",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"branch-protection-policy-proposed",children:"Branch Protection Policy (proposed)"})}),"\n",(0,r.jsxs)(n.p,{children:["This document defines recommended protection settings for ",(0,r.jsx)(n.code,{children:"main"})," to ensure\nquality, security, and traceability."]}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"Goals:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Prevent direct, unreviewed pushes"}),"\n",(0,r.jsx)(n.li,{children:"Enforce status checks + semantic standards"}),"\n",(0,r.jsx)(n.li,{children:"Maintain linear, signed, and provenance-attested history"}),"\n",(0,r.jsx)(n.li,{children:"Enable tag-driven release automation with confidence"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"required-status-checks",children:"Required status checks"}),"\n",(0,r.jsx)(n.p,{children:"Enable branch protection with these required checks (must pass before merge):"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["PR quality (full workflow) \u2014 or job-level checks if you prefer granularity:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Lint"}),"\n",(0,r.jsx)(n.li,{children:"Typecheck"}),"\n",(0,r.jsx)(n.li,{children:"Tests + Coverage"}),"\n",(0,r.jsx)(n.li,{children:"Repo quality checks"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Commitlint \u2014 commit message format validation"}),"\n",(0,r.jsx)(n.li,{children:"PR Title Lint \u2014 semantic pull request title enforcement"}),"\n",(0,r.jsx)(n.li,{children:"Dependency Review \u2014 optional; mark as required to block moderate+ severity"}),"\n",(0,r.jsx)(n.li,{children:"CodeQL \u2014 optional; can run post-merge if latency is a concern"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Context names to select (confirm exact labels in GitHub UI):"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"PR quality"})," (or the job names above)"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"Commitlint"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"PR Title Lint"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"Dependency Review"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"CodeQL"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"additional-protections",children:"Additional protections"}),"\n",(0,r.jsx)(n.p,{children:"Recommended settings:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Require pull request reviews: 1 (consider 2 for critical packages)"}),"\n",(0,r.jsx)(n.li,{children:"Dismiss stale approvals on new commits: enabled"}),"\n",(0,r.jsx)(n.li,{children:"Require review from Code Owners (if CODEOWNERS is added later): enabled"}),"\n",(0,r.jsx)(n.li,{children:"Require status checks to pass before merging: enabled"}),"\n",(0,r.jsx)(n.li,{children:"Require branches to be up to date before merging: enabled (ensures latest base\nref tests run)"}),"\n",(0,r.jsx)(n.li,{children:"Require signed commits: enabled (GPG or GitHub verified signatures)"}),"\n",(0,r.jsx)(n.li,{children:"Require linear history: enabled (disallow merge commits; use squash or rebase)"}),"\n",(0,r.jsx)(n.li,{children:"Allow squash merges: enabled"}),"\n",(0,r.jsx)(n.li,{children:"Allow rebase merges: enabled"}),"\n",(0,r.jsx)(n.li,{children:"Disallow force pushes: enabled"}),"\n",(0,r.jsx)(n.li,{children:"Disallow deletions: enabled"}),"\n",(0,r.jsx)(n.li,{children:"Lock branch: disabled (avoid blocking automation)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"tag-driven-release-flow",children:"Tag-driven release flow"}),"\n",(0,r.jsxs)(n.p,{children:["Once protections are in place, convert ",(0,r.jsx)(n.code,{children:"release.yml"})," trigger from manual to\n",(0,r.jsx)(n.code,{children:"push"})," on version tags:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"on:\n  push:\n    tags:\n      - 'v*.*.*'\n"})}),"\n",(0,r.jsx)(n.p,{children:"Publish process:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Merge changesets PR (version bump commit generated)"}),"\n",(0,r.jsxs)(n.li,{children:["Tag created by Changesets action (",(0,r.jsx)(n.code,{children:"vX.Y.Z"}),")"]}),"\n",(0,r.jsx)(n.li,{children:"Release workflow triggers automatically, builds, publishes, and generates\nSBOM"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Ensure ",(0,r.jsx)(n.code,{children:"NPM_TOKEN"})," scoped to publish only; use provenance (",(0,r.jsx)(n.code,{children:"id-token: write"}),")\nfor npm registry attestations."]}),"\n",(0,r.jsx)(n.h2,{id:"security-considerations",children:"Security considerations"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"All workflows pinned to SHAs; review updates regularly"}),"\n",(0,r.jsxs)(n.li,{children:["Use OIDC (",(0,r.jsx)(n.code,{children:"id-token: write"}),") with npm provenance where supported"]}),"\n",(0,r.jsxs)(n.li,{children:["Keep ",(0,r.jsx)(n.code,{children:"contents: write"})," limited to release/publish workflows"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"future-enhancements",children:"Future enhancements"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Add CODEOWNERS for critical paths"}),"\n",(0,r.jsx)(n.li,{children:"Integrate SLSA build provenance once supported by package managers"}),"\n",(0,r.jsx)(n.li,{children:"Introduce automated license scanning in PR quality workflow"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:"Last updated: 2025-11-12."})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},5705:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>c});var s=i(7701);const r={},l=s.createContext(r);function t(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);