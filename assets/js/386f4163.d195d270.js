"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[9702],{5705:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>t});var r=s(7701);const i={},l=r.createContext(i);function c(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(l.Provider,{value:n},e.children)}},9078:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"release-channels","title":"Release Channels & Prerelease Strategy","description":"\u26a1 Quick Start: For practical, step-by-step instructions on publishing","source":"@site/docs/release-channels.md","sourceDirName":".","slug":"/release-channels","permalink":"/chatline/docs/release-channels","draft":false,"unlisted":false,"editUrl":"https://github.com/nathanvale/chatline/tree/main/website/docs/release-channels.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Prettier Best Practices & Formatting Strategy","permalink":"/chatline/docs/prettier-best-practices"},"next":{"title":"Canonical Changesets Flow \u2014 Zero-touch releases","permalink":"/chatline/docs/releases/changesets-canonical"}}');var i=s(6801),l=s(5705);const c={},t="Release Channels & Prerelease Strategy",a={},d=[{value:"Goals",id:"goals",level:2},{value:"Channel Definitions",id:"channel-definitions",level:2},{value:"Branching Guidance",id:"branching-guidance",level:2},{value:"Workflow Overview",id:"workflow-overview",level:2},{value:"Typical Sequence (Next \u2192 Beta \u2192 RC \u2192 Latest)",id:"typical-sequence-next--beta--rc--latest",level:3},{value:"Canary Snapshots",id:"canary-snapshots",level:3},{value:"Scripts Added (package.json)",id:"scripts-added-packagejson",level:2},{value:"Dist-Tag Behavior",id:"dist-tag-behavior",level:2},{value:"Promotion Mechanics",id:"promotion-mechanics",level:2},{value:"Rollback Plan",id:"rollback-plan",level:2},{value:"Version Hygiene",id:"version-hygiene",level:2},{value:"Security &amp; Provenance",id:"security--provenance",level:2},{value:"CI Consumption Example",id:"ci-consumption-example",level:2},{value:"Risks &amp; Mitigations",id:"risks--mitigations",level:2},{value:"Future Enhancements",id:"future-enhancements",level:2},{value:"References",id:"references",level:2}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"release-channels--prerelease-strategy",children:"Release Channels & Prerelease Strategy"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u26a1 Quick Start:"})," For practical, step-by-step instructions on publishing\npre-releases, see the ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/chatline/docs/pre-release-guide",children:"Pre-Release Guide"})})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["This document defines the multi-channel release process for ",(0,i.jsx)(n.code,{children:"chatline"}),",\nenabling safe iteration and promotion flows while preserving stable ",(0,i.jsx)(n.code,{children:"latest"}),"\nintegrity and supply chain guarantees."]}),"\n",(0,i.jsx)(n.h2,{id:"goals",children:"Goals"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Accelerate feedback cycles (next/beta) without blocking stable work."}),"\n",(0,i.jsx)(n.li,{children:"Provide structured promotion path: next \u2192 beta \u2192 rc \u2192 latest."}),"\n",(0,i.jsx)(n.li,{children:"Support canary snapshots for ultra-fast validation (e.g., CI, downstream\ntests)."}),"\n",(0,i.jsx)(n.li,{children:"Maintain provenance, SBOM generation, and security posture across channels."}),"\n",(0,i.jsx)(n.li,{children:"Avoid main branch blockage during extended prerelease cycles."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"channel-definitions",children:"Channel Definitions"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Channel"}),(0,i.jsx)(n.th,{children:"Tag"}),(0,i.jsx)(n.th,{children:"Purpose"}),(0,i.jsx)(n.th,{children:"Stability Expectations"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"next"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"-next.N"})}),(0,i.jsx)(n.td,{children:"Fast iteration after merge; early adopters & internal consumers."}),(0,i.jsx)(n.td,{children:"Unstable; breaking changes allowed."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"beta"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"-beta.N"})}),(0,i.jsx)(n.td,{children:"Feature complete for target release; focus on integration & perf."}),(0,i.jsx)(n.td,{children:"Mostly stable; avoid new breaking changes."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"rc"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"-rc.N"})}),(0,i.jsx)(n.td,{children:"Release candidate; only critical fixes."}),(0,i.jsx)(n.td,{children:"Should mirror final unless blocker found."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"canary"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"-canary-<timestamp>"})}),(0,i.jsx)(n.td,{children:"Snapshot of current tree for experimentation."}),(0,i.jsx)(n.td,{children:"Ephemeral; not for production."})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"branching-guidance",children:"Branching Guidance"}),"\n",(0,i.jsxs)(n.p,{children:["We keep normal development on ",(0,i.jsx)(n.code,{children:"main"}),". Prerelease mode MUST NOT be entered on\n",(0,i.jsx)(n.code,{children:"main"})," for long-running cycles\u2014create a short-lived branch (e.g.\n",(0,i.jsx)(n.code,{children:"release/1.2-next"}),") and enter prerelease there. Merge back after ",(0,i.jsx)(n.code,{children:"pre exit"})," and\nfinal publish."]}),"\n",(0,i.jsxs)(n.p,{children:["Using ",(0,i.jsx)(n.code,{children:"main"})," directly for a short rc cycle (hours) is acceptable but risky;\nprefer dedicated release branches to avoid blocking unrelated changes."]}),"\n",(0,i.jsx)(n.h2,{id:"workflow-overview",children:"Workflow Overview"}),"\n",(0,i.jsxs)(n.p,{children:["GitHub workflow: ",(0,i.jsx)(n.code,{children:".github/workflows/channel-release.yml"})," provides\n",(0,i.jsx)(n.code,{children:"workflow_dispatch"})," with inputs:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"channel"}),": one of ",(0,i.jsx)(n.code,{children:"next"}),", ",(0,i.jsx)(n.code,{children:"beta"}),", ",(0,i.jsx)(n.code,{children:"rc"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"intent"}),": ",(0,i.jsx)(n.code,{children:"enter"}),", ",(0,i.jsx)(n.code,{children:"version"}),", ",(0,i.jsx)(n.code,{children:"publish"}),", ",(0,i.jsx)(n.code,{children:"exit"}),", ",(0,i.jsx)(n.code,{children:"snapshot"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"typical-sequence-next--beta--rc--latest",children:"Typical Sequence (Next \u2192 Beta \u2192 RC \u2192 Latest)"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Create branch: ",(0,i.jsx)(n.code,{children:"git checkout -b release/1.2-next"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Run channel workflow ",(0,i.jsx)(n.code,{children:"enter"})," with channel=",(0,i.jsx)(n.code,{children:"next"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Iterate: add changesets, run ",(0,i.jsx)(n.code,{children:"version"})," \u2192 ",(0,i.jsx)(n.code,{children:"publish"})," as needed."]}),"\n",(0,i.jsxs)(n.li,{children:["Promote to beta:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Exit ",(0,i.jsx)(n.code,{children:"next"}),": ",(0,i.jsx)(n.code,{children:"intent=exit"})," (removes prerelease suffix internally after next\ncycle?)"]}),"\n",(0,i.jsxs)(n.li,{children:["Enter beta: run workflow with channel=",(0,i.jsx)(n.code,{children:"beta"})," intent=",(0,i.jsx)(n.code,{children:"enter"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Repeat version/publish until feature complete."}),"\n",(0,i.jsxs)(n.li,{children:["Enter rc: channel=",(0,i.jsx)(n.code,{children:"rc"})," intent=",(0,i.jsx)(n.code,{children:"enter"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Final stabilization: small fixes + ",(0,i.jsx)(n.code,{children:"version"})," + ",(0,i.jsx)(n.code,{children:"publish"})," as required."]}),"\n",(0,i.jsxs)(n.li,{children:["Exit rc: ",(0,i.jsx)(n.code,{children:"intent=exit"})," then merge branch into ",(0,i.jsx)(n.code,{children:"main"})," and trigger normal\n",(0,i.jsx)(n.code,{children:"Release"})," workflow (publishes to ",(0,i.jsx)(n.code,{children:"latest"}),")."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"canary-snapshots",children:"Canary Snapshots"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["\u26a0\ufe0f ",(0,i.jsx)(n.strong,{children:"IMPORTANT:"})," Snapshot releases do NOT work when in pre-release mode."]}),"\n",(0,i.jsxs)(n.p,{children:["Changesets explicitly forbids ",(0,i.jsx)(n.code,{children:"changeset version --snapshot"})," when\n",(0,i.jsx)(n.code,{children:".changeset/pre.json"})," exists. To use snapshots, you must first exit pre-mode."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Alternative:"})," When in pre-mode, use versioned pre-releases instead\n(",(0,i.jsx)(n.code,{children:"changeset version"})," + ",(0,i.jsx)(n.code,{children:"changeset publish"}),")."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Use ",(0,i.jsx)(n.code,{children:"intent=snapshot"})," to invoke ",(0,i.jsx)(n.code,{children:"release:snapshot:canary"})," script (only when NOT\nin pre-mode):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"changeset version --snapshot canary\nchangeset publish --tag canary\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Generates versions like ",(0,i.jsx)(n.code,{children:"1.2.0-canary-20250101123045"})," (Changesets auto\ntimestamp). Consumers pin explicitly or use range if appropriate."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Limitation:"})," This workflow only works when ",(0,i.jsx)(n.code,{children:".changeset/pre.json"})," does NOT\nexist. For pre-release workflows, use versioned pre-releases instead."]}),"\n",(0,i.jsx)(n.h2,{id:"scripts-added-packagejson",children:"Scripts Added (package.json)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"pre:enter:next|beta|rc"})," \u2013 enter prerelease mode with tag."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"pre:exit"})," \u2013 prepare exit."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"version:pre"})," \u2013 ",(0,i.jsx)(n.code,{children:"changeset version"})," while in prerelease."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"publish:pre"})," \u2013 ",(0,i.jsx)(n.code,{children:"changeset publish"})," for prerelease tag."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"release:snapshot:canary"})," \u2013 snapshot publishing (\u26a0\ufe0f only works when NOT in\npre-mode)."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"dist-tag-behavior",children:"Dist-Tag Behavior"}),"\n",(0,i.jsxs)(n.p,{children:["Entering prerelease with tag ",(0,i.jsx)(n.code,{children:"next"})," causes publishes to receive the ",(0,i.jsx)(n.code,{children:"next"}),"\ndist-tag. Same for ",(0,i.jsx)(n.code,{children:"beta"})," and ",(0,i.jsx)(n.code,{children:"rc"}),". Snapshot publishes use ",(0,i.jsx)(n.code,{children:"canary"})," tag. After\n",(0,i.jsx)(n.code,{children:"pre exit"})," + final ",(0,i.jsx)(n.code,{children:"changeset version"})," + ",(0,i.jsx)(n.code,{children:"changeset publish"})," on ",(0,i.jsx)(n.code,{children:"main"})," (Release\nworkflow), packages publish to ",(0,i.jsx)(n.code,{children:"latest"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["New packages during prerelease automatically get a ",(0,i.jsx)(n.code,{children:"latest"})," tag on first publish\nper Changesets behavior; subsequent prerelease publishes retain prerelease tag."]}),"\n",(0,i.jsx)(n.h2,{id:"promotion-mechanics",children:"Promotion Mechanics"}),"\n",(0,i.jsxs)(n.p,{children:["Promotion (next \u2192 beta \u2192 rc) is implemented by exiting the prior tag and\nentering the new one on a branch. This creates clean version progression:\n",(0,i.jsx)(n.code,{children:"1.2.0-next.3"})," \u2192 ",(0,i.jsx)(n.code,{children:"1.2.0-beta.0"})," \u2192 ",(0,i.jsx)(n.code,{children:"1.2.0-rc.1"})," \u2192 ",(0,i.jsx)(n.code,{children:"1.2.0"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Avoid stacking simultaneous prerelease tags. Always exit the previous before\nentering the next."}),"\n",(0,i.jsx)(n.h2,{id:"rollback-plan",children:"Rollback Plan"}),"\n",(0,i.jsx)(n.p,{children:"If a prerelease proves invalid:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Tag deprecation: Mark dist-tag as deprecated via npm advisory (manual step) or\ncommunicate in README."}),"\n",(0,i.jsxs)(n.li,{children:["Revert branch commits and re-enter prerelease with incremented sequence\n(",(0,i.jsx)(n.code,{children:"next"})," again) if necessary."]}),"\n",(0,i.jsxs)(n.li,{children:["Never publish a lower semantic version; use new prerelease iteration (e.g.,\nfrom ",(0,i.jsx)(n.code,{children:"1.2.0-beta.2"})," rollback fix becomes ",(0,i.jsx)(n.code,{children:"1.2.0-beta.3"}),")."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"version-hygiene",children:"Version Hygiene"}),"\n",(0,i.jsx)(n.p,{children:"Maintain granular changesets per logical change; avoid mega changesets. Ensure\ndependency bumps propagate during prerelease (Changesets handles unsatisfied\nranges)."}),"\n",(0,i.jsx)(n.h2,{id:"security--provenance",children:"Security & Provenance"}),"\n",(0,i.jsxs)(n.p,{children:["All channel publishes still occur with OIDC provenance (Release workflow handles\nstable; manual channel workflow relies on ",(0,i.jsx)(n.code,{children:"NPM_TOKEN"})," & GitHub token). Consider\nfuture enhancement: add SBOM generation step into channel workflow for parity\n(optional now)."]}),"\n",(0,i.jsx)(n.h2,{id:"ci-consumption-example",children:"CI Consumption Example"}),"\n",(0,i.jsx)(n.p,{children:"Downstream project wanting latest beta:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"pnpm add chatline@beta\n"})}),"\n",(0,i.jsx)(n.p,{children:"For rc testing:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"pnpm add chatline@rc\n"})}),"\n",(0,i.jsx)(n.p,{children:"For canary snapshot pin:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"pnpm add chatline@1.2.0-canary-20250101123045\n"})}),"\n",(0,i.jsx)(n.h2,{id:"risks--mitigations",children:"Risks & Mitigations"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Risk"}),(0,i.jsx)(n.th,{children:"Mitigation"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Main blocked by prerelease mode"}),(0,i.jsx)(n.td,{children:"Use dedicated release branches."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Confusing tag progression"}),(0,i.jsx)(n.td,{children:"Document sequence; enforce exit-before-enter."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:["Forgotten ",(0,i.jsx)(n.code,{children:"pre exit"})," before stable publish"]}),(0,i.jsx)(n.td,{children:"Checklist in PR template (add item)."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Canary instability leaks into beta"}),(0,i.jsx)(n.td,{children:"Keep canary commits separate; require passing tests before promotion."})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"future-enhancements",children:"Future Enhancements"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Automate branch creation & exit/enter sequences with a higher-level\norchestrator action."}),"\n",(0,i.jsx)(n.li,{children:"Add SBOM + OSV scan steps to channel workflow for uniform security posture."}),"\n",(0,i.jsx)(n.li,{children:"Integrate Slack/Teams notifications on publish outputs."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/chatline/docs/pre-release-guide",children:"Pre-Release Guide"})})," - Step-by-step practical guide"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/chatline/docs/automated-release-workflow",children:"Automated Release Workflow"})})," - Main\nrelease documentation"]}),"\n",(0,i.jsxs)(n.li,{children:["Changesets prerelease docs (",(0,i.jsx)(n.code,{children:"pre enter"}),", ",(0,i.jsx)(n.code,{children:"pre exit"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"npm dist-tags reference"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:["For supply chain security layers see ",(0,i.jsx)(n.code,{children:"docs/security-supply-chain.md"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);