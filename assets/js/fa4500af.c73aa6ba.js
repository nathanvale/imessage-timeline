"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[8232],{5411:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>a,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"bun-script-best-practices","title":"Bun script best practices (CLI-focused)","description":"This repository ships a TypeScript CLI (chatline). We leverage Bun","source":"@site/docs/bun-script-best-practices.md","sourceDirName":".","slug":"/bun-script-best-practices","permalink":"/chatline/docs/bun-script-best-practices","draft":false,"unlisted":false,"editUrl":"https://github.com/nathanvale/chatline/tree/main/website/docs/bun-script-best-practices.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Bun Hybrid Implementation Checklist","permalink":"/chatline/docs/bun-hybrid-implementation-checklist"},"next":{"title":"bun-single-repo-best-practices","permalink":"/chatline/docs/bun-single-repo-best-practices"}}');var t=s(6801),c=s(5705);const l={},r="Bun script best practices (CLI-focused)",d={},o=[{value:"Goals",id:"goals",level:2},{value:"What changed",id:"what-changed",level:2},{value:"Scripts (authoritative)",id:"scripts-authoritative",level:2},{value:"CLI development vs. publish",id:"cli-development-vs-publish",level:2},{value:"Testing and CI",id:"testing-and-ci",level:2},{value:"Rationale",id:"rationale",level:2},{value:"Tips",id:"tips",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",ul:"ul",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"bun-script-best-practices-cli-focused",children:"Bun script best practices (CLI-focused)"})}),"\n",(0,t.jsxs)(n.p,{children:["This repository ships a TypeScript CLI (",(0,t.jsx)(n.code,{children:"chatline"}),"). We leverage Bun\nfor local development convenience and faster tooling, while retaining Node +\nVitest for testing and release stability."]}),"\n",(0,t.jsx)(n.h2,{id:"goals",children:"Goals"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Keep publishing/consumption standard: ",(0,t.jsx)(n.code,{children:"bin"})," points to ",(0,t.jsx)(n.code,{children:"dist/cli.js"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"Use Bun for local dev (run TS directly) and for tooling (tsc/eslint/prettier)."}),"\n",(0,t.jsx)(n.li,{children:"Keep tests on Node/Vitest to match CI and avoid environment drift."}),"\n",(0,t.jsx)(n.li,{children:"Continue using pnpm as the package manager."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"what-changed",children:"What changed"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Dev runs the CLI straight from TypeScript via Bun: ",(0,t.jsx)(n.code,{children:"pnpm dev"})," \u2192\n",(0,t.jsx)(n.code,{children:"bun src/cli.ts"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"tsc"}),", ",(0,t.jsx)(n.code,{children:"eslint"}),", and ",(0,t.jsx)(n.code,{children:"prettier"})," are invoked through ",(0,t.jsx)(n.code,{children:"bunx"})," for speed."]}),"\n",(0,t.jsxs)(n.li,{children:["Tests stay on Node/Vitest (",(0,t.jsx)(n.code,{children:"pnpm vitest ..."}),")."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"scripts-authoritative",children:"Scripts (authoritative)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["build: ",(0,t.jsx)(n.code,{children:"bunx --bun tsc -p tsconfig.json"})]}),"\n",(0,t.jsxs)(n.li,{children:["dev: ",(0,t.jsx)(n.code,{children:"bun src/cli.ts"})]}),"\n",(0,t.jsxs)(n.li,{children:["watch: ",(0,t.jsx)(n.code,{children:"bunx --bun tsc -p tsconfig.json --watch"})]}),"\n",(0,t.jsxs)(n.li,{children:["lint: ",(0,t.jsx)(n.code,{children:"bunx --bun eslint ."})]}),"\n",(0,t.jsxs)(n.li,{children:["lint:fix: ",(0,t.jsx)(n.code,{children:"bunx --bun eslint . --fix"})]}),"\n",(0,t.jsxs)(n.li,{children:["format: ",(0,t.jsx)(n.code,{children:"bunx --bun prettier -w ."})]}),"\n",(0,t.jsxs)(n.li,{children:["typecheck: ",(0,t.jsx)(n.code,{children:"bunx --bun tsc -p tsconfig.eslint.json --noEmit"})]}),"\n",(0,t.jsxs)(n.li,{children:["validate:json: ",(0,t.jsx)(n.code,{children:"bun scripts/validate-json.ts"})]}),"\n",(0,t.jsxs)(n.li,{children:["test: ",(0,t.jsx)(n.code,{children:"vitest run"})," (Node)"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Notes:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"bin"})," remains ",(0,t.jsx)(n.code,{children:"./dist/cli.js"})," for published usage. Dev uses Bun to avoid a\nbuild step when iterating locally."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"tsconfig.json"})," stays strict for production builds. ",(0,t.jsx)(n.code,{children:"tsconfig.eslint.json"}),"\npowers fast no-emit type checking for lint/type safety (tests excluded)."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"cli-development-vs-publish",children:"CLI development vs. publish"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Development:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Run: ",(0,t.jsx)(n.code,{children:"pnpm dev -- --help"})," (args after ",(0,t.jsx)(n.code,{children:"--"})," are forwarded to the CLI)"]}),"\n",(0,t.jsxs)(n.li,{children:["Build: ",(0,t.jsx)(n.code,{children:"pnpm build"})," \u2192 emits ",(0,t.jsx)(n.code,{children:"dist/**"})]}),"\n",(0,t.jsxs)(n.li,{children:["Local dist run: ",(0,t.jsx)(n.code,{children:"pnpm cli -- --help"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Publish consumers:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Use the installed command ",(0,t.jsx)(n.code,{children:"chatline"})," (resolves to ",(0,t.jsx)(n.code,{children:"dist/cli.js"}),")."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"testing-and-ci",children:"Testing and CI"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Continue to use Vitest on Node:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Local: ",(0,t.jsx)(n.code,{children:"pnpm test"}),", ",(0,t.jsx)(n.code,{children:"pnpm test:watch"})]}),"\n",(0,t.jsxs)(n.li,{children:["CI: ",(0,t.jsx)(n.code,{children:"pnpm test:ci"})," with JUnit/coverage reporters (see ",(0,t.jsx)(n.code,{children:"vitest.config.ts"}),")"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Coverage uses V8 and thresholds configured in ",(0,t.jsx)(n.code,{children:"vitest.config.ts"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"rationale",children:"Rationale"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Bun offers very fast startup and excellent TypeScript support for dev loops."}),"\n",(0,t.jsx)(n.li,{children:"Keeping tests on Node avoids cross-runtime inconsistencies and keeps CI\ndeterministic."}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"bunx"})," provides a drop-in way to run tool CLIs without changing the package\nmanager (",(0,t.jsx)(n.code,{children:"pnpm"})," remains primary)."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"tips",children:"Tips"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Forward CLI args in dev with ",(0,t.jsx)(n.code,{children:"--"}),", e.g.:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"pnpm dev -- --config examples/imessage-config.yaml"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["If you don't have Bun installed locally, install it from ",(0,t.jsx)(n.a,{href:"https://bun.sh",children:"https://bun.sh"}),"."]}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},5705:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>r});var i=s(7701);const t={},c=i.createContext(t);function l(e){const n=i.useContext(c);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(c.Provider,{value:n},e.children)}}}]);